# urlencode does not encode forward slashes
- set_fact:
    _remote_uri: "{{ _idp.remote_id | replace('https://', '') | urlencode | replace('/', '%2f') }}"

- set_fact:
    setupMounts:
      - name: keystone-openidc-metadata
        mountPath: /var/lib/apache2/oidc/{{ _remote_uri }}.client
        subPath: "{{ _idp.realm_name }}-oidc-client"
      - name: keystone-openidc-metadata
        mountPath: /var/lib/apache2/oidc/{{ _remote_uri }}.conf
        subPath: "{{ _idp.realm_name }}-oidc-conf"
      - name: keystone-openidc-metadata
        mountPath: /var/lib/apache2/oidc/{{ _remote_uri }}.provider
        subPath: "{{ _idp.realm_name }}-oidc-profile"

- set_fact:
    _mountPoints: "{{ _mountPoints + setupMounts }}"
