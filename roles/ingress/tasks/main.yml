# Copyright (c) 2025 VEXXHOST, Inc.
# SPDX-License-Identifier: Apache-2.0

- name: Create Ingress {{ ingress_name }}
  run_once: true
  kubernetes.core.k8s:
    state: present
    template: ingress.yml.j2
  # NOTE(fitbeard): Sometimes this fails because the 'ingress-nginx' is still not ready.
  #                 We need to wait for ingress controller to be ready.
  retries: 60
  delay: 5
  register: ingress_result
  until: ingress_result is not failed
