---
apiVersion: identity.openstack.atmosphere.vexxhost.com/v1alpha1
kind: Service
metadata:
  name: swift
  namespace: openstack
spec:
  type: object-store
  description: OpenStack Object Storage
---
apiVersion: identity.openstack.atmosphere.vexxhost.com/v1alpha1
kind: Endpoint
metadata:
  name: swift-internal
  namespace: openstack
spec:
  region: "{{ openstack_helm_endpoints_region_name }}"
  serviceRef:
    name: swift
    namespace: openstack
  interface: internal
  url: "http://rook-ceph-rgw-rook-ceph.rook-ceph.svc.cluster.local/swift/v1/%(tenant_id)s"
---
apiVersion: identity.openstack.atmosphere.vexxhost.com/v1alpha1
kind: Endpoint
metadata:
  name: swift-public
  namespace: openstack
spec:
  region: "{{ openstack_helm_endpoints_region_name }}"
  serviceRef:
    name: swift
    namespace: openstack
  interface: public
  url: "https://object-storage.{{ atmosphere_domain }}/swift/v1/%(tenant_id)s"
---
apiVersion: identity.openstack.atmosphere.vexxhost.com/v1alpha1
kind: Role
metadata:
  name: member
  namespace: openstack
---
apiVersion: identity.openstack.atmosphere.vexxhost.com/v1alpha1
kind: Role
metadata:
  name: load-balancer-member
  namespace: openstack
spec:
  roleName: load-balancer_member
---
apiVersion: identity.openstack.atmosphere.vexxhost.com/v1alpha1
kind: ImpliedRole
metadata:
  name: member-implies-load-balancer-member
  namespace: openstack
spec:
  roleRef:
    name: member
  impliedRoleRef:
    name: load-balancer-member
---
apiVersion: v1
kind: Secret
metadata:
  name: atmosphere-secrets
  namespace: openstack
stringData:
  keystone-admin-password: "{{ openstack_helm_endpoints_keystone_admin_password }}"
  magnum-database-password: "{{ openstack_helm_endpoints_magnum_mariadb_password }}"
  magnum-keystone-password: "{{ openstack_helm_endpoints_magnum_keystone_password }}"
  magnum-rabbitmq-password: "{{ openstack_helm_endpoints_magnum_rabbitmq_password }}"
  memcache-secret-key: "{{ openstack_helm_endpoints_memcached_secret_key }}"
---
apiVersion: atmosphere.vexxhost.com/v1alpha1
kind: Cloud
metadata:
  name: atmosphere
  namespace: openstack
spec: {{ _atmosphere_cloud_spec | combine(atmosphere_cloud_spec, recursive=True) | to_json }}
