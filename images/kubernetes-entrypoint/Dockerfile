# SPDX-License-Identifier: Apache-2.0
# Atmosphere-Rebuild-Time: 2024-06-25T22:49:25Z

FROM harbor.atmosphere.dev/docker.io/library/golang:1.21 AS build
ARG KUBERNETES_ENTRYPOINT_GIT_REPO
ARG KUBERNETES_ENTRYPOINT_GIT_REF
ADD ${KUBERNETES_ENTRYPOINT_GIT_REPO}#${KUBERNETES_ENTRYPOINT_GIT_REF} /src
WORKDIR /src
RUN CGO_ENABLED=0 GOOS=linux go build -o /main

FROM scratch
COPY --from=build /main /kubernetes-entrypoint
USER 65534
ENTRYPOINT ["/kubernetes-entrypoint"]
